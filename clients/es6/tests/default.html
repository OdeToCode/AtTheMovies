<html>
<head>
    <title>Testing</title>
    <link rel="stylesheet" href="/bower_components/jasmine/lib/jasmine-core/jasmine.css">
    <script src="/bower_components/jasmine/lib/jasmine-core/jasmine.js"></script>
    <script src="/bower_components/jasmine/lib/jasmine-core/jasmine-html.js"></script>
    <script src="/bower_components/jasmine/lib/jasmine-core/boot.js"></script>
</head>

<body>
    <script src="/bower_components/traceur/traceur.js"></script>
    <script>
        new traceur.WebPageTranscoder(document.location.href).run();
        traceur.options.experimental = true;
    </script>
    <script type="module">

    </script>

    <script type="module">
        describe("array comprehensions", function(){

           it("should double integers", function(){
               var numbers = [1,2,3];
               var doubles = [for (n of numbers) n*2];
               expect(doubles).toEqual([2,4,6]);
           });

           it("should filter numbers", function(){
                var numbers = [1,2,3,4];
                var result = [for (i of numbers) if(i % 2 ==0) i * 2];
                expect(result).toEqual([4,8]);
           });

        });

        describe("arrow functions", function(){

            it("should look like c#!", function(){
                var square = x => x * x;
                var result = square(3);

                expect(result).toBe(9);
            });

            it("can work with map", function() {
                var numbers = [1,2,3,4];
                var result = numbers.map(x => x * x);

                expect(result).toEqual([1,4,9,16]);
            });

            it("should remember this", function(done){
                this.name = "Scott";
                setTimeout(() => {
                    expect(this.name).toBe("Scott");
                    done();
                }, 0);
            });

            it("which usually doesn't happen", function(done){
                this.name = "Scott";
                setTimeout(function()  {
                    expect(this.name).toBe("");
                    done();
                }, 0);
            });

        });



    </script>
</body>
</html>