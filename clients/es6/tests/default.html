<html>
<head>
    <title>Testing</title>
    <link rel="stylesheet" href="/bower_components/jasmine/lib/jasmine-core/jasmine.css">
    <script src="/bower_components/jasmine/lib/jasmine-core/jasmine.js"></script>
    <script src="/bower_components/jasmine/lib/jasmine-core/jasmine-html.js"></script>
    <script src="/bower_components/jasmine/lib/jasmine-core/boot.js"></script>
</head>

<body>
    <script src="/bower_components/traceur/traceur.js"></script>
    <script>
        new traceur.WebPageTranscoder(document.location.href).run();
        traceur.options.experimental = true;
    </script>
    <script type="module">

    </script>

    <script type="module">
        describe("array comprehensions", function(){

           it("should double integers", function(){
               var numbers = [1,2,3];
               var doubles = [for (n of numbers) n*2];
               expect(doubles).toEqual([2,4,6]);
           });

           it("should filter numbers", function(){
                var numbers = [1,2,3,4];
                var result = [for (i of numbers) if(i % 2 ==0) i * 2];
                expect(result).toEqual([4,8]);
           });

        });

        describe("arrow functions", function(){

            it("should look like c#!", function(){
                var square = x => x * x;
                var result = square(3);

                expect(result).toBe(9);
            });

            it("can work with map", function() {
                var numbers = [1,2,3,4];
                var result = numbers.map(x => x * x);

                expect(result).toEqual([1,4,9,16]);
            });

            it("should remember this", function(done){
                this.name = "Scott";
                setTimeout(() => {
                    expect(this.name).toBe("Scott");
                    done();
                }, 0);
            });

            it("which usually doesn't happen", function(done){
                this.name = "Scott";
                setTimeout(function()  {
                    expect(this.name).toBe("");
                    done();
                }, 0);
            });

            describe("a point class", function() {

                class Point {
                    constructor(x,y){
                        this._x = x;
                        this._y = y;
                    }
                    get x() { return this._x; }
                    set x(value) {
                        if(value < 0) throw "invalid x value";
                        this._x = value;
                    }
                    get y() { return this._y; }
                }


                it("has getters and setters", function(){
                    var p = new Point(2,10);
                    p.x = 20;

                    expect(p.x).toBe(20);
                    expect(p.y).toBe(10);
                });

            });

            describe("default parameters", function(){

                var f = function(foo = 1, bar = "two"){

                    return {
                        foo:foo,
                        bar:bar
                    };
                };

                it("can specify a value", function(){
                    var result = f();

                    expect(result.foo).toBe(1);
                    expect(result.bar).toBe("two");
                });
            });

            describe("destructuring", function(){
                it("can assign multiples in one line", function(){

                    var [x, y, z] = [1, "two", 3];
                     expect(x).toBe(1);
                     expect(y).toBe("two");
                     expect(z).toBe(3);

                });
            });

            describe("templates", function(){

                it("should templatize", function(){
                    var world = "World";
                    var result = `Hello ${world}!`;
                    expect(result).toBe("Hello World!");
                });

            });

            describe("rest parameters", function(){

                var sum = function(...args) {

                    var result = 0;
                    for(var i = 0; i < args.length; i++){
                        result += args[i];
                    }
                  return result;

                };

                it("is like varargs", function(){
                    var result = sum(1,2,3);
                    expect(result).toBe(6);
                });

            });

        });



    </script>


    Modules (in progress)
    Iterators and For Of Loops
    Generators
    Deferred Functions - Strawman
    Block Scoped Bindings
    Destructuring Assignment
    Default Parameters
    Rest Parameters
    Spread Operator
    Object Initialiser Shorthand
    Property Method Assignment


    Computed Property Names
    Destructuring Assignment
    Iterators and For Of
    Generator Comprehension
    Generators
    Modules
    Numeric Literals
    Property Method Assignment
    Object Initializer Shorthand
    Spread
    Template Literals
    Promises

    And these are only experimental and need to be turned on manually:
    Block Scoped Binding
    Symbols
    Async Functions
    Types
    Annotations
</body>
</html>